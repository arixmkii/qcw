From 10f9c9a7e8abbe5ec9b792a7c62aa4b6a41750ac Mon Sep 17 00:00:00 2001
From: Arthur Sengileyev <arthur.sengileyev@gmail.com>
Date: Sat, 16 Aug 2025 21:33:53 +0300
Subject: [PATCH] Configurable GINKGOTIMEOUT in `winmake.ps1`

Allows to override default timeout values for test runs.

Signed-off-by: Arthur Sengileyev <arthur.sengileyev@gmail.com>
---
 winmake.ps1 | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/winmake.ps1 b/winmake.ps1
index 247b729986..957695c893 100644
--- a/winmake.ps1
+++ b/winmake.ps1
@@ -69,7 +69,8 @@ function Local-Unit {
     $skippackages+="pkg\domain\infra\abi,pkg\emulation,pkg\machine\apple,pkg\machine\applehv,pkg\machine\e2e,pkg\machine\libkrun,"
     $skippackages+="pkg\machine\provider,pkg\machine\proxyenv,pkg\machine\qemu,pkg\specgen\generate,pkg\systemd,test\e2e,test\utils,cmd\rootlessport,"
     $skippackages+="pkg\pidhandle"
-    Run-Command "./bin/ginkgo.exe -vv -r --tags `"$remotetags`" --timeout=15m --trace --no-color --skip-package `"$skippackages`""
+    if ($null -eq $ENV:GINKGOTIMEOUT) { $ENV:GINKGOTIMEOUT = '--timeout=15m' }
+    Run-Command "./bin/ginkgo.exe -vv -r --tags `"$remotetags`" ${ENV:GINKGOTIMEOUT} --trace --no-color --skip-package `"$skippackages`""
 }
 
 function Local-Machine {
@@ -86,7 +87,8 @@ function Local-Machine {
         $focus = "--focus ""$FOCUS"" --silence-skips"
     }
 
-    Run-Command "./bin/ginkgo.exe -vv --tags `"$remotetags`" --timeout=50m --trace --no-color $focus $files pkg/machine/e2e/."
+    if ($null -eq $ENV:GINKGOTIMEOUT) { $ENV:GINKGOTIMEOUT = '--timeout=50m' }
+    Run-Command "./bin/ginkgo.exe -vv --tags `"$remotetags`" ${ENV:GINKGOTIMEOUT} --trace --no-color $focus $files pkg/machine/e2e/."
 }
 
 # Expect starting directory to be /podman
-- 
2.50.1

